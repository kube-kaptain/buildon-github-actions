# SPDX-License-Identifier: MIT
# Copyright (c) 2025-2026 Kaptain contributors (Fred Cooke)

name: 'Kubernetes Manifests Package'
description: 'Packages Kubernetes manifests into a zip with variable substitution'

inputs:
  # Action-specific inputs
  project-name:
    description: 'Project name for output naming'
    required: true
  version:
    description: 'Version for output naming'
    required: true

  # INJECT-INPUT: output-sub-path
  # INJECT-INPUT: token-substitution

outputs:
  manifests-zip-sub-path:
    description: 'Directory containing the zip file (relative)'
    value: ${{ steps.package.outputs.MANIFESTS_ZIP_SUB_PATH }}
  manifests-zip-file-name:
    description: 'Filename of the zip'
    value: ${{ steps.package.outputs.MANIFESTS_ZIP_FILE_NAME }}

runs:
  using: 'composite'
  steps:
    - name: Package manifests
      id: package
      shell: bash
      env:
        BUILD_PLATFORM: github-actions
        BUILD_PLATFORM_LOG_PROVIDER: github-actions
        PROJECT_NAME: ${{ inputs.project-name }}
        VERSION: ${{ inputs.version }}
        OUTPUT_SUB_PATH: ${{ inputs.output-sub-path }}
        TOKEN_DELIMITER_STYLE: ${{ inputs.token-delimiter-style }}
        CONFIG_VALUE_TRAILING_NEWLINE: ${{ inputs.config-value-trailing-newline }}
      run: "${{ github.action_path }}/../../scripts/main/kubernetes-manifests-package"
