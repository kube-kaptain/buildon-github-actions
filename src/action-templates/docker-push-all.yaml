# SPDX-License-Identifier: MIT
# Copyright (c) 2025-2026 Kaptain contributors (Fred Cooke)

name: 'Docker Push All'
description: 'Pushes all Docker images registered during build/tag steps'

inputs:
  # INJECT-INPUT: docker-push-image-list

  # Action-specific inputs
  is-release:
    description: 'Whether to push (true) or skip (false)'
    required: true
  # INJECT-INPUT: image-build-command
  # INJECT-INPUT: docker-platform

outputs:
  images-pushed:
    description: 'Number of images pushed'
    value: ${{ steps.push.outputs.IMAGES_PUSHED }}

runs:
  using: 'composite'
  steps:
    - name: Push all images
      id: push
      shell: bash
      env:
        BUILD_PLATFORM: github-actions
        BUILD_PLATFORM_LOG_PROVIDER: github-actions
        DOCKER_PUSH_IMAGE_LIST_FILE: ${{ inputs.docker-push-image-list-file }}
        IS_RELEASE: ${{ inputs.is-release }}
        IMAGE_BUILD_COMMAND: ${{ inputs.image-build-command }}
        DOCKER_PLATFORM: ${{ inputs.docker-platform }}
      run: "${{ github.action_path }}/../../scripts/main/docker-push-all"
