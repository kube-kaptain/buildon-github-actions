#!/usr/bin/env bash
# SPDX-License-Identifier: MIT
# Copyright (c) 2025-2026 Kaptain contributors (Fred Cooke)
#
# git-push-tag - Pushes an existing git tag to origin
#
# Inputs (environment variables):
#   GIT_TAG    - Tag to push (required)
#   IS_RELEASE - "true" to push, "false" to skip (default: false)
#
set -euo pipefail

SCRIPT_DIR="$(dirname "${0}")"

# shellcheck source=src/scripts/defaults/platform.bash
source "${SCRIPT_DIR}/../defaults/platform.bash"

# shellcheck source=src/scripts/lib/log.bash
source "${SCRIPT_DIR}/../lib/log.bash"

# Required inputs
GIT_TAG="${GIT_TAG:?GIT_TAG is required}"

# Optional inputs with defaults
IS_RELEASE="${IS_RELEASE:-false}"

if [[ "${IS_RELEASE}" == "true" ]]; then
  log "Pushing tag: ${GIT_TAG}"
  git push origin "${GIT_TAG}"
else
  log "Skipping tag push (IS_RELEASE=${IS_RELEASE})"
fi
