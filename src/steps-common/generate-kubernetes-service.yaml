# SPDX-License-Identifier: MIT
# Copyright (c) 2025-2026 Kaptain contributors (Fred Cooke)

- name: Generate Service manifest
  id: generate-service
  if: inputs.kubernetes-service-generation-enabled != 'false' && (inputs.kubernetes-service-generation-enabled == 'true' || inputs.kubernetes-workload-type == 'deployment' || inputs.kubernetes-workload-type == 'statefulset' || inputs.kubernetes-workload-type == 'daemonset')
  uses: ./.github/buildon-github-actions/src/actions/generate-kubernetes-service
  with:
    # Service settings
    kubernetes-service-generation-enabled: ${{ inputs.kubernetes-service-generation-enabled }}
    kubernetes-service-type: ${{ inputs.kubernetes-service-type }}
    kubernetes-service-port: ${{ inputs.kubernetes-service-port }}
    kubernetes-service-target-port: ${{ inputs.kubernetes-service-target-port }}
    kubernetes-service-protocol: ${{ inputs.kubernetes-service-protocol }}
    kubernetes-service-port-name: ${{ inputs.kubernetes-service-port-name }}
    kubernetes-service-node-port: ${{ inputs.kubernetes-service-node-port }}
    kubernetes-service-external-name: ${{ inputs.kubernetes-service-external-name }}
    kubernetes-service-external-traffic-policy: ${{ inputs.kubernetes-service-external-traffic-policy }}
    kubernetes-service-name-suffix: ${{ inputs.kubernetes-service-name-suffix }}
    kubernetes-service-combined-sub-path: ${{ inputs.kubernetes-service-combined-sub-path }}
    kubernetes-service-additional-labels: ${{ inputs.kubernetes-service-additional-labels }}
    kubernetes-service-additional-annotations: ${{ inputs.kubernetes-service-additional-annotations }}
    # Workload settings (for defaults)
    kubernetes-workload-type: ${{ inputs.kubernetes-workload-type }}
    kubernetes-workload-container-port: ${{ inputs.kubernetes-workload-container-port }}
    # Required context
    project-name: ${{ steps.versions.outputs.project-name }}
    # Global settings
    output-sub-path: ${{ inputs.output-sub-path }}
    token-name-style: ${{ inputs.token-name-style }}
    token-delimiter-style: ${{ inputs.token-delimiter-style }}
    kubernetes-global-additional-labels: ${{ inputs.kubernetes-global-additional-labels }}
    kubernetes-global-additional-annotations: ${{ inputs.kubernetes-global-additional-annotations }}
