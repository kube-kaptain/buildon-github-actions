# SPDX-License-Identifier: MIT
# Copyright (c) 2025-2026 Kaptain contributors (Fred Cooke)

- name: Run pre-docker prepare
  if: inputs.hook-pre-docker-prepare-script-sub-path != ''
  id: pre-docker-prepare
  uses: ./.github/buildon-github-actions/src/actions/hook-pre-docker-prepare
  with:
    script-sub-path: ${{ inputs.hook-pre-docker-prepare-script-sub-path }}
    # === Workflow Inputs ===
    # Build output
    output-sub-path: ${{ inputs.output-sub-path }}

    # Docker registry logins
    docker-registry-logins: ${{ inputs.docker-registry-logins }}
    # Docker build options
    dockerfile-sub-path: ${{ inputs.dockerfile-sub-path }}
    dockerfile-squash: ${{ inputs.dockerfile-squash }}
    dockerfile-no-cache: ${{ inputs.dockerfile-no-cache }}
    # Docker target config
    docker-target-registry: ${{ inputs.docker-target-registry }}
    docker-target-base-path: ${{ inputs.docker-target-base-path }}
    # Docker push targets
    docker-push-targets: ${{ inputs.docker-push-targets }}

    # Manifests source
    manifests-sub-path: ${{ inputs.manifests-sub-path }}
    # Manifests packaging
    manifests-repo-provider-type: ${{ inputs.manifests-repo-provider-type }}
    manifests-packaging-base-image: ${{ inputs.manifests-packaging-base-image }}

    # Kubernetes Generation
    kubernetes-global-additional-labels: ${{ inputs.kubernetes-global-additional-labels }}
    kubernetes-global-additional-annotations: ${{ inputs.kubernetes-global-additional-annotations }}
    # Kubernetes ConfigMap Generation
    kubernetes-configmap-sub-path: ${{ inputs.kubernetes-configmap-sub-path }}
    kubernetes-configmap-name-checksum-injection: ${{ inputs.kubernetes-configmap-name-checksum-injection }}
    kubernetes-configmap-additional-labels: ${{ inputs.kubernetes-configmap-additional-labels }}
    kubernetes-configmap-additional-annotations: ${{ inputs.kubernetes-configmap-additional-annotations }}
    # Kubernetes Secret template generation
    kubernetes-secret-template-sub-path: ${{ inputs.kubernetes-secret-template-sub-path }}
    kubernetes-secret-template-name-checksum-injection: ${{ inputs.kubernetes-secret-template-name-checksum-injection }}
    kubernetes-secret-template-additional-labels: ${{ inputs.kubernetes-secret-template-additional-labels }}
    kubernetes-secret-template-additional-annotations: ${{ inputs.kubernetes-secret-template-additional-annotations }}
    # Kubernetes ServiceAccount generation
    kubernetes-serviceaccount-generation-enabled: ${{ inputs.kubernetes-serviceaccount-generation-enabled }}
    kubernetes-serviceaccount-name-suffix: ${{ inputs.kubernetes-serviceaccount-name-suffix }}
    kubernetes-serviceaccount-combined-sub-path: ${{ inputs.kubernetes-serviceaccount-combined-sub-path }}
    kubernetes-serviceaccount-additional-labels: ${{ inputs.kubernetes-serviceaccount-additional-labels }}
    kubernetes-serviceaccount-additional-annotations: ${{ inputs.kubernetes-serviceaccount-additional-annotations }}

    # Token substitution
    token-delimiter-style: ${{ inputs.token-delimiter-style }}
    token-name-style: ${{ inputs.token-name-style }}
    token-name-validation: ${{ inputs.token-name-validation }}
    allow-builtin-token-override: ${{ inputs.allow-builtin-token-override }}
    config-sub-path: ${{ inputs.config-sub-path }}
    config-value-trailing-newline: ${{ inputs.config-value-trailing-newline }}

    # Naming, Versions, and Tags calculation
    release-branch: ${{ inputs.release-branch }}
    additional-release-branches: ${{ inputs.additional-release-branches }}
    tag-version-max-parts: ${{ inputs.tag-version-max-parts }}
    tag-version-calculation-strategy: ${{ inputs.tag-version-calculation-strategy }}
    tag-version-pattern-type: ${{ inputs.tag-version-pattern-type }}
    tag-version-prefix-parts: ${{ inputs.tag-version-prefix-parts }}
    tag-version-source-sub-path: ${{ inputs.tag-version-source-sub-path }}
    tag-version-source-file-name: ${{ inputs.tag-version-source-file-name }}
    tag-version-source-custom-pattern: ${{ inputs.tag-version-source-custom-pattern }}

    # Quality check options
    block-slashes: ${{ inputs.block-slashes }}
    qc-block-slash-containing-branches: ${{ inputs.qc-block-slash-containing-branches }}
    qc-block-double-hyphen-containing-branches: ${{ inputs.qc-block-double-hyphen-containing-branches }}
    qc-require-conventional-branches: ${{ inputs.qc-require-conventional-branches }}
    qc-require-conventional-commits: ${{ inputs.qc-require-conventional-commits }}
    qc-block-conventional-commits: ${{ inputs.qc-block-conventional-commits }}

    # Hook script paths
    hook-pre-tagging-tests-script-sub-path: ${{ inputs.hook-pre-tagging-tests-script-sub-path }}
    hook-pre-docker-prepare-script-sub-path: ${{ inputs.hook-pre-docker-prepare-script-sub-path }}
    hook-post-docker-tests-script-sub-path: ${{ inputs.hook-post-docker-tests-script-sub-path }}
    hook-pre-package-prepare-script-sub-path: ${{ inputs.hook-pre-package-prepare-script-sub-path }}
    hook-post-package-tests-script-sub-path: ${{ inputs.hook-post-package-tests-script-sub-path }}

    # GitHub release
    github-release-enabled: ${{ inputs.github-release-enabled }}
    github-release-substituted-files: ${{ inputs.github-release-substituted-files }}
    github-release-verbatim-files: ${{ inputs.github-release-verbatim-files }}
    github-release-notes: ${{ inputs.github-release-notes }}
    github-release-add-version-to-filenames: ${{ inputs.github-release-add-version-to-filenames }}

    # === Step Outputs ===
    # Version outputs (from versions-and-naming)
    version: ${{ steps.versions.outputs.version }}
    version-major: ${{ steps.versions.outputs.version-major }}
    version-minor: ${{ steps.versions.outputs.version-minor }}
    version-patch: ${{ steps.versions.outputs.version-patch }}
    version-2-part: ${{ steps.versions.outputs.version-2-part }}
    version-3-part: ${{ steps.versions.outputs.version-3-part }}
    version-4-part: ${{ steps.versions.outputs.version-4-part }}
    docker-tag: ${{ steps.versions.outputs.docker-tag }}
    docker-image-name: ${{ steps.versions.outputs.docker-image-name }}
    git-tag: ${{ steps.versions.outputs.git-tag }}
    project-name: ${{ steps.versions.outputs.project-name }}
    is-release: ${{ steps.versions.outputs.is-release }}
    # Docker outputs (computed path for this position)
    docker-substituted-sub-path: ${{ inputs.output-sub-path }}/docker/substituted
